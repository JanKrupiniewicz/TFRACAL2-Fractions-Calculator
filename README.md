My solution to the SPOJ problem:
https://pl.spoj.com/problems/TFRACAL2/
